![Project logo](https://raw.githubusercontent.com/jf-guillou/lcds/master/web/images/lcds_logo-200.png)

# Light Centralized Digital Signage
> Pretty much self explainatory

[![Build Status](https://travis-ci.org/jf-guillou/lcds.svg?branch=master)](https://travis-ci.org/jf-guillou/lcds) [![Scrutinizer Code Quality](https://scrutinizer-ci.com/g/jf-guillou/lcds/badges/quality-score.png?b=master)](https://scrutinizer-ci.com/g/jf-guillou/lcds/?branch=master) [![GitHub license](https://img.shields.io/badge/license-New%20BSD-blue.svg)](https://raw.githubusercontent.com/jf-guillou/lcds/master/LICENSE.md)

There are already dozens of digital signage managers. But no easy to use opensource CMS based projects.

Now there's this one.

Based on the [Yii2 framework](http://www.yiiframework.com/).
See [https://github.com/jf-guillou/lcds/blob/master/composer.json](composer.json) for the complete list of extensions used in this project.

**Table of contents**
- [Requirements](#requirements)
- [Installation](#installation)
  - [Install app](#install-app)
  - [Database](#database)
  - [App configuration](#app-configuration)
  - [Web Server configuration](#web-server-configuration)
    - [Apache](#apache)
    - [Nginx](#nginx)
  - [Ready](#ready)
- [Upgrade](#upgrade)


## REQUIREMENTS

- PHP >= 5.6
- php5-ldap / php7-ldap
- MySQL >= 5.5 OR MariaDB >= 10.0
- [Composer](https://getcomposer.org/)
> Lower PHP versions are unsupported but should work

## INSTALLATION

### Install app

```bash
composer self-update
composer global require "fxp/composer-asset-plugin:^1.2.0"
cd /path/to/install
git clone https://github.com/jf-guillou/lcds.git
cd lcds
composer install --no-dev
```

### Database

Edit the database configuration file `config/db.php` according to your settings.
> Make sure to modify the `dbname=`, `username` and `password`.

Then run the migrations to pre-fill the database :
```bash
./yii migrate --interactive=0
```

### App configuration

Edit the app configuration file `config/params.php` :

- `language` - Currently supported :
  - en-US
  - fr-FR
- `prettyUrl` - See [Enable pretty URLS](#enable-pretty-urls)
- `cookieValidationKey` - Should be automaticaly generated by composer, should not be modified
- `proxy` - Outgoing proxy if necessary, used by media downloaders
- `useKerberos` - If the web server is Kerberos enabled
- `kerberosPrincipalVar` - The HTTP environement variable containing the user principal for Kerberos
- `useLdap` - Use LDAP for authentication backend
- `ldapOptions` - Common options for LDAP, default values should help you understand their meaning
- `cookieDuration` - Cookie duration in seconds, 0 will disable cookies
- `agenda` - Agenda image renderer configuration
  - `calendarTimezone` - Timezone input from calendar feed
  - `displayTeachers` - Display teachers name if space is not an issue
- `weather` - Weather renderer configuration / See https://darksky.net/dev for more details
  - `language` - Summary text language
  - `units` - Temperature units
  - `apikey` - API key used to fetch weather status
  - `withSummary` - Display text summary alongside icon


### Web Server configuration

The [Yii2 framework](http://www.yiiframework.com/) document root is in the /web folder

#### Apache
```
DocumentRoot "/path/to/install/lcds/web"
```

##### Enable pretty urls
Add to Apache configuration
```
<Directory "/path/to/install/lcds/web">
    # use mod_rewrite for pretty URL support
    RewriteEngine on
    # If a directory or a file exists, use the request directly
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    # Otherwise forward the request to index.php
    RewriteRule . index.php

    # ...other settings...
</Directory>
```

#### Nginx
```
root /path/to/install/lcds/web;
```

##### Enable pretty urls
Add to Nginx configuration
```
location / {
    # Redirect everything that isn't a real file to index.php
    try_files $uri $uri/ /index.php$is_args$args;
}
```

### Ready

The app should be ready to use.
Do not hesitate to report bugs by posting an [https://github.com/jf-guillou/lcds/issues](issue at github)


## UPGRADE

```bash
composer self-update
composer global update
cd /path/to/install/lcds
git pull
composer install --no-dev
./yii migrate --interactive=0
```
