![Project logo](https://raw.githubusercontent.com/jf-guillou/lcds/master/web/images/lcds_logo-200.png)

# Light Centralized Digital Signage

There are already dozens of digital signage managers. But no easy to use open-source CMS based projects.

Now there's this one, still in **beta**.

Based on the [Yii2 framework](http://www.yiiframework.com/).
See [https://github.com/jf-guillou/lcds/blob/master/composer.json](composer.json) for the complete list of extensions used in this project.

[![Build Status](https://travis-ci.org/jf-guillou/lcds.svg?branch=master)](https://travis-ci.org/jf-guillou/lcds) [![Scrutinizer Code Quality](https://scrutinizer-ci.com/g/jf-guillou/lcds/badges/quality-score.png?b=master)](https://scrutinizer-ci.com/g/jf-guillou/lcds/?branch=master) [![GitHub license](https://img.shields.io/badge/license-New%20BSD-blue.svg)](https://raw.githubusercontent.com/jf-guillou/lcds/master/LICENSE.md)

**Table of contents**
- [Requirements](#requirements)
- [Installation](#installation)
  - [Install app](#install-app)
  - [Database](#database)
  - [App configuration](#app-configuration)
  - [Web Server configuration](#web-server-configuration)
    - [Apache](#apache)
    - [Nginx](#nginx)
  - [Ready](#ready)
- [Upgrade](#upgrade)
- [Client](#client)
- [Raspberry Pi Client](#raspberry-pi-client)
  - [Client installation](#client-installation)
  - [Auto-Configuration](#auto-configuration)
  - [Manual configuration](#manual-configuration)



## REQUIREMENTS

- PHP >= 5.6
- php5-ldap / php7-ldap
- MySQL >= 5.5 OR MariaDB >= 10.0
- [Composer](https://getcomposer.org/)
> Lower PHP versions are unsupported but should work

### Optional

- youtube-dl : Used by HostedVideo sideloader -- Make sure to keep updated
```bash
sudo wget https://yt-dl.org/downloads/latest/youtube-dl -O /usr/local/bin/youtube-dl
sudo chmod a+rx /usr/local/bin/youtube-dl
```

## INSTALLATION

**Do not forget to change /path/to/install in the following guide to your liking.**

### Install app

```bash
composer self-update
composer global require "fxp/composer-asset-plugin:^1.2.0"
cd /path/to/install
git clone -b production https://github.com/jf-guillou/lcds.git
cd lcds
composer install --no-dev
```

### Database

Edit the database configuration file `config/db.php` according to your settings.
> Make sure to modify the `dbname=`, `username` and `password`.

Then run the migrations to pre-fill the database :
```bash
./yii migrate --interactive=0
```

### App configuration

Edit the app configuration file `config/params.php` :

- `language` - Currently supported :
  - `en-US`
  - `fr-FR`
- `prettyUrl` - See [Enable pretty URLS](#enable-pretty-urls)
- `cookieValidationKey` - Should be automatically generated by composer, should not be modified
- `proxy` - Outgoing proxy if necessary, used by media downloaders
- `useKerberos` - If the web server is Kerberos enabled
- `kerberosPrincipalVar` - The HTTP environment variable containing the user principal for Kerberos
- `useLdap` - Use LDAP for authentication backend
- `ldapOptions` - Common options for LDAP, default values should help you understand their meaning
- `cookieDuration` - Cookie duration in seconds, 0 will disable cookies
- `weather` - Weather renderer configuration / See https://darksky.net/dev for more details
  - `language` - Summary text language
  - `units` - Temperature units
  - `apikey` - API key used to fetch weather status
  - `withSummary` - Display text summary alongside icon


### Web Server configuration

The [Yii2 framework](http://www.yiiframework.com/) document root is in the /web folder

#### Apache
```
DocumentRoot "/path/to/install/lcds/web"
```

##### Enable pretty urls
Add to Apache configuration
```
<Directory "/path/to/install/lcds/web">
    # use mod_rewrite for pretty URL support
    RewriteEngine on
    # If a directory or a file exists, use the request directly
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    # Otherwise forward the request to index.php
    RewriteRule . index.php
    # ...other settings...
</Directory>
```

#### Nginx
```
root /path/to/install/lcds/web;
```

##### Enable pretty urls
Add to Nginx configuration
```
location / {
    # Redirect everything that isn't a real file to index.php
    try_files $uri $uri/ /index.php$is_args$args;
}
```

### Ready

The app should be ready to use.
Do not hesitate to report bugs by posting an [issue at Github](https://github.com/jf-guillou/lcds/issues)


## UPGRADE

```bash
composer self-update
composer global update
cd /path/to/install/lcds
git pull
composer install --no-dev
./yii migrate --interactive=0
```

## CLIENT

The client configuration mostly depends on the hardware you are going to use.

Basically, just set the homepage of the browser to your web server address with '/frontend' suffix

`https://lcds-server/frontend`

## Raspberry Pi Client

If you want to use a Raspberry Pi, you probably need (some setup)[https://github.com/jf-guillou/lcds-rpi-client].
